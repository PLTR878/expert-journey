function openTv(symbol){
  const m = document.getElementById('tvModal');
  const box = document.getElementById('tv');

  // สร้างพื้นที่สำหรับกราฟ
  box.innerHTML = '<div id="tv_chart" style="height:500px"></div>';

  // ลบสคริปต์ TradingView เดิมออก (ถ้ามี)
  const oldScript = document.querySelector('script[src="https://s3.tradingview.com/tv.js"]');
  if (oldScript) oldScript.remove();

  // โหลดสคริปต์ใหม่
  const script = document.createElement('script');
  script.src = 'https://s3.tradingview.com/tv.js';
  script.onload = () => {
    new TradingView.widget({
      width: "100%",
      height: 500,
      symbol: symbol,
      interval: "D",
      theme: "dark",
      style: "1",
      locale: "th",
      container_id: "tv_chart"
    });
  };
  document.body.appendChild(script);

  // แสดงกล่อง modal
  m.style.display = 'flex';
}
